<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 📡802.11g Transmitter|Scrambler · PA's Blog</title><meta name="description" content="📡802.11g Transmitter|Scrambler - Puzzled Alex"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://pa.radonyl.xyz/atom.xml" title="PA's Blog"><meta name="generator" content="Hexo 4.0.0"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/alalelel" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">📡802.11g Transmitter|Scrambler</h1><div class="post-info">Nov 9, 2019</div><div class="post-content"><font face="微软雅黑" size=4>**📍扰码器简介**</font>
<a id="more"></a>
<table><tr><td bgcolor=#F0F8FF>
&#8195;&#8195;数字通信中，如果经常出现长的0或1序列，将会影响位同
步的建立和保持。在发射机中使用扰码，可以<font color=red>避免这种数据对接收机定时的不利影响</font>。同时，为了限制电路中存在的不同程度的非线性特性对其他电路通信造成的串扰，<font color=red>要求数字信号的最小周期足够长</font>。将数字信号变换成<font color=red>具有近似于白噪声统计特性的数字序列</font>即可满足要求，这通常用加扰来实现。</td></tr></table>

<font face="黑体微软雅黑" size=4>**🎈原理**</font>

<blockquote>
<p>&#8195;&#8195;所谓加扰，就是<strong>不用增加冗余而扰乱信号</strong>，改变数字信号统计特性，使其具有近似白噪声统计特性的一种技术。在OFDM中，DATA域数据的处理，首先需要进行加扰操作。整个DATA域数据使用一个长度为127的帧同步扰码器加扰。8位PSDU数据帧转换成<strong>串行比特流</strong>，其中，LSB在前，MSB在最后。扰码器使用下列生成多项式:<script type="math/tex">\mathbf{S(x) = x^7 + x^4 + 1}</script>也就是将数据数据送入该多项式，然后输出。输出后的结果就是扰码之后的结果。该扰码器的最高幂是7，首先要定义一个7位非零的伪随机处置状态，比如说是 1011101。经过上面的多项式之后，生成一个127位的随机数。</p>
</blockquote>
<p><font face="黑体微软雅黑" size=4><strong>🎈实现</strong></font><br>&#8195;&#8195;扰码器可以用一个7位移位寄存器SCRAMBLER实现。扰码模块的模块框图和端口定义如下：<br><img src="https://raw.githubusercontent.com/radonyl/pa_blog_img/master/fimg/Picture1.png" alt="Picture1.png"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">端口名</th>
<th style="text-align:center">位宽</th>
<th style="text-align:center">输入/输出</th>
<th style="text-align:center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">SCRAM_DIN</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">扰码器输入信号</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_ND</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">扰码器输入有效，与输入信号同步拉高</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_LOAD</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">扰码器初始设置信号</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_RST</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">复位信号，低电平有效</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_CLK</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">时钟信号(60MHz)</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_SEED</td>
<td style="text-align:center">7</td>
<td style="text-align:center">Input</td>
<td style="text-align:center">扰码器初始状态值，此处为7’b1011101</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_DOUT</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Output</td>
<td style="text-align:center">扰码器输出信号</td>
</tr>
<tr>
<td style="text-align:center">SCRAM_RDY</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Output</td>
<td style="text-align:center">扰码器输出有效，与输出信号同步拉高</td>
</tr>
</tbody>
</table>
</div>
<p><font face="黑体微软雅黑" size=4><strong>🎈代码</strong></font><br>&#8195;&#8195;当扰码器初始设置信号SCRAM_LOAD为高电平时，扰码器被设置成一个非零的伪随机状态。此处取非零伪随机状态为SCRAM_SEED=1011101<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SCRAM_SEED = <span class="number">7</span><span class="string">'b1011101;</span></span><br><span class="line"><span class="string">if(SCRAM_LOAD)</span></span><br><span class="line"><span class="string">    SCRAMBLER &lt;= SCRAM_SEED;</span></span><br></pre></td></tr></table></figure><br>&#8195;&#8195;当扰码器输入有效信号SCRAM_ND为高电平时，每个时钟周期扰码器状态左移一位，并且第7位和第4位进行异或运算，所得的值一方面作为寄存器的输入，另一方面和输入的串行比特流进行异或运算得到加扰后的输出数据SCRAM_DOUT。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(SCRAM_ND)</span><br><span class="line">    begin</span><br><span class="line">        SCRAM_DOUT &lt;= SCRAM_DIN + data_temp[<span class="number">7</span>] + SCRAMBLER[<span class="number">4</span>];</span><br><span class="line">        SCRAMBLER &lt;= &#123;SCRAMBLER[<span class="number">6</span>:<span class="number">1</span>],data_temp[<span class="number">7</span>] + SCRAMBLER[<span class="number">4</span>]&#125;;</span><br><span class="line">    end</span><br></pre></td></tr></table></figure></p>
<p><font face="黑体微软雅黑" size=4><strong>🎈仿真结果</strong></font><br>&#8195;&#8195;对工程文件进行综合、布局、布线后仿真，得到如下图所示的仿真结果:<br><img src="https://raw.githubusercontent.com/radonyl/pa_blog_img/master/fimg/Picture2.png" alt="Picture2.png"><br>&#8195;&#8195;上图中，din是输入扰码器的两个Symbol，每个Symbol为144个bit;dout为扰码处理后的输出，同样输出两个Symbol的数据，每个Symbol有144个bit已扰码数据。</p>
<blockquote>
<p>&#8195;&#8195;将仿真通过的工程文件使用ChipScope添加观察信号采样时钟、触发信号和待观察信号后重新综合、布局布线生成bit文件，下载到目标板后用ChipScope进行在线测试，得到观测结果如下图所示。下图中的DIN对应上图中的din，下图中的DOUT对应上图中的dout。下图的在线测试结果与上图的后仿真结果吻合，验证了设计的正确性。</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/radonyl/pa_blog_img/master/fimg/Picture3.png" alt="Picture3.png"></p>
</div></article></div></main><footer><div class="paginator"><a href="/2019/11/09/802-11g-Transmitter-9-ad9361-hdl/" class="prev">PREV</a><a href="/2019/11/08/802-11g-Transmitter-8-controller/" class="next">NEXT</a></div><div class="copyright"><p>© 2019 <a href="http://pa.radonyl.xyz">Puzzled Alex</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>